/*!
 * Farbtastic: jQuery color picker plug-in v1.3u
 * https://github.com/mattfarina/farbtastic
 *
 * Licensed under the GPL license:
 *   http://www.gnu.org/licenses/gpl.html
 */(function(a){a.fn.farbtastic=function(b){return a.farbtastic(this,b),this},a.farbtastic=function(b,c){var b=a(b).get(0);return b.farbtastic||(b.farbtastic=new a._farbtastic(b,c))},a._farbtastic=function(d,e){var b=this,c;a(d).html('<div class="farbtastic"><div class="color"></div><div class="wheel"></div><div class="overlay"></div><div class="h-marker marker"></div><div class="sl-marker marker"></div></div>'),c=a('.farbtastic',d),b.wheel=a('.wheel',d).get(0),b.radius=84,b.square=100,b.width=194,navigator.appVersion.match(/MSIE [0-6]\./)&&a('*',c).each(function(){if(this.currentStyle.backgroundImage!='none'){var b=this.currentStyle.backgroundImage;b=this.currentStyle.backgroundImage.substring(5,b.length-2),a(this).css({backgroundImage:'none',filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='"+b+"')"})}}),b.linkTo=function(c){return typeof b.callback=='object'&&a(b.callback).off('keyup',b.updateValue),b.color=null,typeof c=='function'?b.callback=c:(typeof c=='object'||typeof c=='string')&&(b.callback=a(c),b.callback.on('keyup',b.updateValue),b.callback.get(0).value&&b.setColor(b.callback.get(0).value)),this},b.updateValue=function(a){this.value&&this.value!=b.color&&b.setColor(this.value)},b.setColor=function(a){var c=b.unpack(a);return b.color!=a&&c&&(b.color=a,b.rgb=c,b.hsl=b.RGBToHSL(b.rgb),b.updateDisplay()),this},b.setHSL=function(a){return b.hsl=a,b.rgb=b.HSLToRGB(a),b.color=b.pack(b.rgb),b.updateDisplay(),this},b.widgetCoords=function(c){var d=a(b.wheel).offset();return{x:c.pageX-d.left-b.width/2,y:c.pageY-d.top-b.width/2}},b.mousedown=function(c){document.dragging||(a(document).on('mousemove',b.mousemove).on('mouseup',b.mouseup),document.dragging=!0);var d=b.widgetCoords(c);return b.circleDrag=Math.max(Math.abs(d.x),Math.abs(d.y))*2>b.square,b.mousemove(c),!1},b.mousemove=function(d){var a=b.widgetCoords(d),c,e,f;return b.circleDrag?(c=Math.atan2(a.x,-a.y)/6.28,c<0&&(c+=1),b.setHSL([c,b.hsl[1],b.hsl[2]])):(e=Math.max(0,Math.min(1,-(a.x/b.square)+.5)),f=Math.max(0,Math.min(1,-(a.y/b.square)+.5)),b.setHSL([b.hsl[0],e,f])),!1},b.mouseup=function(){a(document).off('mousemove',b.mousemove),a(document).off('mouseup',b.mouseup),document.dragging=!1},b.updateDisplay=function(){var d=b.hsl[0]*6.28;a('.h-marker',c).css({left:Math.round(Math.sin(d)*b.radius+b.width/2)+'px',top:Math.round(-Math.cos(d)*b.radius+b.width/2)+'px'}),a('.sl-marker',c).css({left:Math.round(b.square*(.5-b.hsl[1])+b.width/2)+'px',top:Math.round(b.square*(.5-b.hsl[2])+b.width/2)+'px'}),a('.color',c).css('backgroundColor',b.pack(b.HSLToRGB([b.hsl[0],1,.5]))),typeof b.callback=='object'?(a(b.callback).css({backgroundColor:b.color,color:b.hsl[2]>.5?'#000':'#fff'}),a(b.callback).each(function(){this.value&&this.value!=b.color&&(this.value=b.color)})):typeof b.callback=='function'&&b.callback.call(b,b.color)},b.pack=function(a){var b=Math.round(a[0]*255),c=Math.round(a[1]*255),d=Math.round(a[2]*255);return'#'+(b<16?'0':'')+b.toString(16)+(c<16?'0':'')+c.toString(16)+(d<16?'0':'')+d.toString(16)},b.unpack=function(a){if(a.length==7)return[parseInt('0x'+a.substring(1,3))/255,parseInt('0x'+a.substring(3,5))/255,parseInt('0x'+a.substring(5,7))/255];if(a.length==4)return[parseInt('0x'+a.substring(1,2))/15,parseInt('0x'+a.substring(2,3))/15,parseInt('0x'+a.substring(3,4))/15]},b.HSLToRGB=function(d){var e=d[0],f=d[1],b=d[2],a=b<=.5?b*(f+1):b+f-b*f,c=b*2-a,i,h,g;return[this.hueToRGB(c,a,e+.33333),this.hueToRGB(c,a,e),this.hueToRGB(c,a,e-.33333)]},b.hueToRGB=function(b,c,a){return a=a<0?a+1:a>1?a-1:a,a*6<1?b+(c-b)*a*6:a*2<1?c:a*3<2?b+(c-b)*(.66666-a)*6:b},b.RGBToHSL=function(i){var c=i[0],f=i[1],g=i[2],j=Math.min(c,Math.min(f,g)),a=Math.max(c,Math.max(f,g)),d=a-j,b=(j+a)/2,h=0,e;return b>0&&b<1&&(h=d/(b<.5?2*b:2-2*b)),e=0,d>0&&(a==c&&a!=f&&(e+=(f-g)/d),a==f&&a!=g&&(e+=2+(g-c)/d),a==g&&a!=c&&(e+=4+(c-f)/d),e/=6),[e,h,b]},a('*',c).on('mousedown',b.mousedown),b.setColor('#000000'),e&&b.linkTo(e)}})(jQuery)